import{d as y,a as z,Q as te}from"./format-util.3d0400b0.js";import{a7 as g,W as f,aO as k,aG as D,X as Y,ba as i,a5 as t,cL as x,_ as a,B as L,bI as b,bM as B,bJ as P,F as O,y as ae,bE as oe,k as $,b5 as re,aA as se}from"./index.cff9ac5d.js";import{f as ne,e as ue}from"./reservation.fe42a8fb.js";import{f as le}from"./room.70f71cf9.js";import{Q as w}from"./QInnerLoading.5c1f95a1.js";import{Q as N}from"./QTable.5ee997c8.js";import"./_commonjsHelpers.2cf1d77b.js";import"./QVirtualScroll.7365e47a.js";import"./QSelect.fa044258.js";const ie=a("div",{class:"text-h6"},"\uB9E4\uCD9C\uC561 (\uC804\uB144 \uB300\uBE44)",-1),ce=g({__name:"YearlyRevenueChart",props:{chartData:{type:Object,required:!0,validator:e=>e.currentYear&&e.previousYear},isLoading:{type:Boolean,default:!1}},setup(e){const d=e,c=f(()=>{const o=y().year(),h=o-1;return[{name:`${o}\uB144`,data:d.chartData.currentYear.map(l=>l.value)},{name:`${h}\uB144`,data:d.chartData.previousYear.map(l=>l.value)}]}),v=f(()=>({chart:{type:"line",toolbar:{show:!1},zoom:{enabled:!1}},stroke:{curve:"smooth",width:[3,2],dashArray:[0,5]},dataLabels:{enabled:!1},colors:["#1976d2","#9C27B0"],xaxis:{categories:d.chartData.currentYear.map(o=>o.label+"\uC6D4"),labels:{style:{fontSize:"12px"}}},yaxis:{labels:{formatter:function(o){return z(o)}}},tooltip:{y:{formatter:function(o){return z(o)}}},legend:{position:"top"}}));return(o,h)=>{const l=k("apexchart");return D(),Y(B,{flat:"",bordered:""},{default:i(()=>[t(b,null,{default:i(()=>[ie,t(w,{showing:e.isLoading},{default:i(()=>[t(x,{size:"50px",color:"primary"})]),_:1},8,["showing"]),a("div",{class:L(["q-mt-md",{invisible:e.isLoading}])},[t(l,{type:"line",height:"250",options:v.value,series:c.value},null,8,["options","series"])],2)]),_:1})]),_:1})}}}),de=a("div",{class:"text-h6"},"\uC608\uC57D \uAC74\uC218 (\uC804\uB144 \uB300\uBE44)",-1),pe=g({__name:"YearlyReservationCountChart",props:{chartData:{type:Object,required:!0,validator:e=>e.currentYear&&e.previousYear},isLoading:{type:Boolean,default:!1}},setup(e){const d=e,c=f(()=>{const o=y().year(),h=o-1;return[{name:`${o}\uB144`,data:d.chartData.currentYear.map(l=>l.value)},{name:`${h}\uB144`,data:d.chartData.previousYear.map(l=>l.value)}]}),v=f(()=>({chart:{type:"line",toolbar:{show:!1},zoom:{enabled:!1}},stroke:{curve:"smooth",width:[3,2],dashArray:[0,5]},dataLabels:{enabled:!1},colors:["#00C853","#FF9800"],xaxis:{categories:d.chartData.currentYear.map(o=>o.label+"\uC6D4"),labels:{style:{fontSize:"12px"}}},tooltip:{y:{formatter:function(o){return`${o}\uAC74`}}},legend:{position:"top"}}));return(o,h)=>{const l=k("apexchart");return D(),Y(B,{flat:"",bordered:""},{default:i(()=>[t(b,null,{default:i(()=>[de,t(w,{showing:e.isLoading},{default:i(()=>[t(x,{size:"50px",color:"primary"})]),_:1},8,["showing"]),a("div",{class:L(["q-mt-md",{invisible:e.isLoading}])},[t(l,{type:"line",height:"250",options:v.value,series:c.value},null,8,["options","series"])],2)]),_:1})]),_:1})}}}),me=a("div",{class:"text-h6"},"\uB2E4\uB140\uAC04 \uC778\uC6D0 \uC218 (\uC804\uB144 \uB300\uBE44)",-1),he=g({__name:"YearlyPeopleCountChart",props:{chartData:{type:Object,required:!0,validator:e=>e.currentYear&&e.previousYear},isLoading:{type:Boolean,default:!1}},setup(e){const d=e,c=f(()=>{const o=y().year(),h=o-1;return[{name:`${o}\uB144`,data:d.chartData.currentYear.map(l=>l.value)},{name:`${h}\uB144`,data:d.chartData.previousYear.map(l=>l.value)}]}),v=f(()=>({chart:{type:"line",toolbar:{show:!1},zoom:{enabled:!1}},stroke:{curve:"smooth",width:[3,2],dashArray:[0,5]},dataLabels:{enabled:!1},colors:["#E91E63","#7C4DFF"],xaxis:{categories:d.chartData.currentYear.map(o=>o.label+"\uC6D4"),labels:{style:{fontSize:"12px"}}},tooltip:{y:{formatter:function(o){return`${o}\uBA85`}}},legend:{position:"top"}}));return(o,h)=>{const l=k("apexchart");return D(),Y(B,{flat:"",bordered:""},{default:i(()=>[t(b,null,{default:i(()=>[me,t(w,{showing:e.isLoading},{default:i(()=>[t(x,{size:"50px",color:"primary"})]),_:1},8,["showing"]),a("div",{class:L(["q-mt-md",{invisible:e.isLoading}])},[t(l,{type:"line",height:"250",options:v.value,series:c.value},null,8,["options","series"])],2)]),_:1})]),_:1})}}}),ve=a("div",{class:"text-h6"},"\uC608\uC57D\uB41C \uAC1D\uC2E4 \uC218 (\uC804\uB144 \uB300\uBE44)",-1),fe=g({__name:"YearlyRoomCountChart",props:{chartData:{type:Object,required:!0,validator:e=>e.currentYear&&e.previousYear},isLoading:{type:Boolean,default:!1}},setup(e){const d=e,c=f(()=>{const o=y().year(),h=o-1;return[{name:`${o}\uB144`,data:d.chartData.currentYear.map(l=>l.value)},{name:`${h}\uB144`,data:d.chartData.previousYear.map(l=>l.value)}]}),v=f(()=>({chart:{type:"line",toolbar:{show:!1},zoom:{enabled:!1}},stroke:{curve:"smooth",width:[3,2],dashArray:[0,5]},dataLabels:{enabled:!1},colors:["#00BCD4","#FF5722"],xaxis:{categories:d.chartData.currentYear.map(o=>o.label+"\uC6D4"),labels:{style:{fontSize:"12px"}}},tooltip:{y:{formatter:function(o){return`${o}\uAC1C`}}},legend:{position:"top"}}));return(o,h)=>{const l=k("apexchart");return D(),Y(B,{flat:"",bordered:""},{default:i(()=>[t(b,null,{default:i(()=>[ve,t(w,{showing:e.isLoading},{default:i(()=>[t(x,{size:"50px",color:"primary"})]),_:1},8,["showing"]),a("div",{class:L(["q-mt-md",{invisible:e.isLoading}])},[t(l,{type:"line",height:"250",options:v.value,series:c.value},null,8,["options","series"])],2)]),_:1})]),_:1})}}}),Ce={class:"row items-center"},_e={class:"text-h6"},ye=g({__name:"MonthSelector",props:{selectedMonth:{type:String,required:!0}},emits:["update:selectedMonth"],setup(e,{emit:d}){const c=e,v=d,o=f(()=>{const C=c.selectedMonth.split("-")[0],R=c.selectedMonth.split("-")[1];return`${C}\uB144 ${R}\uC6D4 \uD1B5\uACC4`});function h(){v("update:selectedMonth","previous")}function l(){v("update:selectedMonth","next")}return(C,R)=>(D(),Y(B,{flat:"",bordered:""},{default:i(()=>[t(b,null,{default:i(()=>[a("div",Ce,[t(P,{icon:"chevron_left",flat:"",round:"",onClick:h}),a("div",_e,O(o.value),1),t(P,{icon:"chevron_right",flat:"",round:"",onClick:l})])]),_:1})]),_:1}))}}),ge=a("div",{class:"text-h6"},"\uB9E4\uCD9C\uC561",-1),De=g({__name:"MonthlySalesCard",props:{totalSales:{type:Number,required:!0},isLoading:{type:Boolean,default:!1}},setup(e){return(d,c)=>(D(),Y(B,{flat:"",bordered:""},{default:i(()=>[t(b,null,{default:i(()=>[ge,t(w,{showing:e.isLoading},{default:i(()=>[t(x,{size:"50px",color:"primary"})]),_:1},8,["showing"]),a("div",{class:L(["text-h4 q-mt-sm text-primary",{invisible:e.isLoading}])},O(ae(z)(e.totalSales)),3)]),_:1})]),_:1}))}}),Ye=a("div",{class:"text-h6"},"\uC608\uC57D \uAC74\uC218",-1),be=g({__name:"MonthlyReservationCountCard",props:{totalReservations:{type:Number,required:!0},isLoading:{type:Boolean,default:!1}},setup(e){return(d,c)=>(D(),Y(B,{flat:"",bordered:""},{default:i(()=>[t(b,null,{default:i(()=>[Ye,t(w,{showing:e.isLoading},{default:i(()=>[t(x,{size:"50px",color:"primary"})]),_:1},8,["showing"]),a("div",{class:L(["text-h4 q-mt-sm text-primary",{invisible:e.isLoading}])},O(e.totalReservations)+"\uAC74",3)]),_:1})]),_:1}))}}),Be=a("div",{class:"text-h6"},"\uAC1D\uC2E4\uBCC4 \uC608\uC57D \uBC30\uC815 \uAC74\uC218",-1),xe=g({__name:"RoomAllocationTable",props:{roomAllocationStats:{type:Array,required:!0},isLoading:{type:Boolean,default:!1}},setup(e){const d=[{name:"roomGroup",label:"\uAC1D\uC2E4 \uADF8\uB8F9",field:"roomGroup",align:"left"},{name:"count",label:"\uC608\uC57D \uAC74\uC218",field:"count",align:"left"},{name:"rooms",label:"\uD3EC\uD568 \uAC1D\uC2E4",field:"rooms",align:"left",format:c=>c.join(", ")}];return(c,v)=>(D(),Y(B,{flat:"",bordered:""},{default:i(()=>[t(b,null,{default:i(()=>[Be,t(w,{showing:e.isLoading},{default:i(()=>[t(x,{size:"50px",color:"primary"})]),_:1},8,["showing"]),a("div",{class:L({invisible:e.isLoading})},[t(N,{rows:e.roomAllocationStats,columns:d,"row-key":"roomGroup",flat:"",bordered:""},null,8,["rows"])],2)]),_:1})]),_:1}))}}),Le=a("div",{class:"text-h6"},"\uAC1D\uC2E4 \uADF8\uB8F9\uBCC4 \uD3C9\uADE0 \uC810\uC720\uC728",-1),we=g({__name:"RoomGroupOccupancyTable",props:{roomGroupOccupancyStats:{type:Array,required:!0},isLoading:{type:Boolean,default:!1}},setup(e){const d=[{name:"roomGroup",label:"\uAC1D\uC2E4 \uADF8\uB8F9",field:"roomGroup",align:"left"},{name:"roomCount",label:"\uAC1D\uC2E4 \uC218",field:"roomCount",align:"left"},{name:"occupancyRate",label:"\uC810\uC720\uC728",field:"occupancyRate",align:"left",format:c=>`${c}%`}];return(c,v)=>(D(),Y(B,{flat:"",bordered:""},{default:i(()=>[t(b,null,{default:i(()=>[Le,t(w,{showing:e.isLoading},{default:i(()=>[t(x,{size:"50px",color:"primary"})]),_:1},8,["showing"]),a("div",{class:L({invisible:e.isLoading})},[t(N,{rows:e.roomGroupOccupancyStats,columns:d,"row-key":"roomGroup",flat:"",bordered:""},null,8,["rows"])],2)]),_:1})]),_:1}))}}),Ae=a("div",{class:"text-h6"},"\uCD1D \uB2E4\uB140\uAC04 \uC778\uC6D0",-1),Me=g({__name:"MonthlyGuestsCard",props:{totalGuests:{type:Number,required:!0},isLoading:{type:Boolean,default:!1}},setup(e){return(d,c)=>(D(),Y(B,{flat:"",bordered:""},{default:i(()=>[t(b,null,{default:i(()=>[Ae,t(w,{showing:e.isLoading},{default:i(()=>[t(x,{size:"50px",color:"primary"})]),_:1},8,["showing"]),a("div",{class:L(["text-h4 q-mt-sm text-primary",{invisible:e.isLoading}])},O(e.totalGuests)+"\uBA85",3)]),_:1})]),_:1}))}}),Se={class:"q-pa-md"},qe=a("div",{class:"text-h4 q-mb-md"},"\uD1B5\uACC4",-1),$e={class:"row q-col-gutter-md q-mb-md"},Re={class:"col-12"},Ee={class:"row q-col-gutter-md q-mb-md"},Ge={class:"col-12"},ke={class:"row q-col-gutter-md q-mb-md"},Oe={class:"col-12"},ze={class:"row q-col-gutter-md q-mb-md"},Fe={class:"col-12"},Qe={class:"row q-col-gutter-md"},Pe={class:"col-12"},Ne={class:"col-12"},je={class:"row q-col-gutter-md q-mb-md"},Ke={class:"col-12 col-md-6"},Ie={class:"col-12 col-md-6"},Te={class:"row q-col-gutter-md q-mb-md"},Ve={class:"col-12"},Je={class:"row q-col-gutter-md q-mb-md"},Ue={class:"col-12"},We={class:"row q-col-gutter-md"},Xe={class:"col-12 col-md-6"},ut=g({__name:"StatsPage",setup(e){const d=oe(),c=$(y().format("YYYY-MM")),v=$([]),o=$([]),h=$(!1),l=$(!1),C=$({currentYear:{revenue:{},reservations:{},peopleCount:{},roomCount:{}},previousYear:{revenue:{},reservations:{},peopleCount:{},roomCount:{}}}),R=f(()=>{const n=[],u=[];for(let r=1;r<=12;r++){const s=r.toString().padStart(2,"0"),p=s;n.push({key:s,label:p,value:C.value.currentYear.revenue[s]||0}),u.push({key:s,label:p,value:C.value.previousYear.revenue[s]||0})}return{currentYear:n,previousYear:u}}),j=f(()=>{const n=[],u=[];for(let r=1;r<=12;r++){const s=r.toString().padStart(2,"0"),p=s;n.push({key:s,label:p,value:C.value.currentYear.reservations[s]||0}),u.push({key:s,label:p,value:C.value.previousYear.reservations[s]||0})}return{currentYear:n,previousYear:u}}),K=f(()=>{const n=[],u=[];for(let r=1;r<=12;r++){const s=r.toString().padStart(2,"0"),p=s;n.push({key:s,label:p,value:C.value.currentYear.peopleCount[s]||0}),u.push({key:s,label:p,value:C.value.previousYear.peopleCount[s]||0})}return{currentYear:n,previousYear:u}}),I=f(()=>{const n=[],u=[];for(let r=1;r<=12;r++){const s=r.toString().padStart(2,"0"),p=s;n.push({key:s,label:p,value:C.value.currentYear.roomCount[s]||0}),u.push({key:s,label:p,value:C.value.previousYear.roomCount[s]||0})}return{currentYear:n,previousYear:u}});function T(n){n==="previous"?c.value=y(c.value).subtract(1,"month").format("YYYY-MM"):n==="next"&&(c.value=y(c.value).add(1,"month").format("YYYY-MM"))}const V=f(()=>v.value.reduce((n,u)=>n+u.price,0)),J=f(()=>v.value.length),U=f(()=>{const n=new Map;return o.value.forEach(u=>{const r=u.roomGroup.name;n.has(r)||n.set(r,{roomGroup:r,count:0,rooms:[]}),n.get(r).rooms.push(u.number)}),v.value.forEach(u=>{u.rooms.forEach(r=>{const s=r.roomGroup.name;n.has(s)&&n.get(s).count++})}),Array.from(n.values())}),W=f(()=>{if(o.value.length===0)return[];const n=y(c.value).daysInMonth(),u=new Map;return o.value.forEach(r=>{const s=r.roomGroup.name,p=r.roomGroup.id;u.has(p)||u.set(p,{roomGroup:s,roomCount:0,occupiedDays:0,occupancyRate:0}),u.get(p).roomCount++}),v.value.forEach(r=>{const s=y(r.stayStartAt),M=y(r.stayEndAt).diff(s,"day");r.rooms.forEach(q=>{const S=q.roomGroup.id;u.has(S)&&(u.get(S).occupiedDays+=M)})}),u.forEach(r=>{const s=r.roomCount*n;r.occupancyRate=s>0?(r.occupiedDays/s*100).toFixed(2):0}),Array.from(u.values())}),X=f(()=>v.value.reduce((n,u)=>n+(u.peopleCount||0),0));async function F(){h.value=!0;try{const n=y(c.value).startOf("month").format("YYYY-MM-DD"),u=y(c.value).endOf("month").format("YYYY-MM-DD"),r={stayStartAt:n,stayEndAt:u,size:1e3},[s,p]=await Promise.all([ne(r),le({})]);v.value=s.values,o.value=p.values,(!C.value.revenue||Object.keys(C.value.revenue).length===0)&&await H()}catch(n){console.error("\uB370\uC774\uD130 \uB85C\uB4DC \uC911 \uC624\uB958 \uBC1C\uC0DD:",n),d.notify({message:"\uD1B5\uACC4 \uB370\uC774\uD130\uB97C \uBD88\uB7EC\uC624\uB294 \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD588\uC2B5\uB2C8\uB2E4.",type:"negative",actions:[{icon:"close",color:"white",round:!0}]})}finally{h.value=!1}}async function H(){l.value=!0;const n=y(),u={},r={},s={},p={},M={},q={},S={},E={},Z=n.subtract(23,"month").startOf("month").format("YYYY-MM-DD"),ee=n.endOf("month").format("YYYY-MM-DD");try{(await ue(Z,ee)).value.stats.forEach(m=>{const _=y(m.period+"-01"),A=_.format("MM");_.year()===n.year()?(u[A]=m.totalSales,r[A]=m.totalReservations,s[A]=m.totalGuests||0,p[A]=Math.round(m.totalReservations*1.2)||0):_.year()===n.year()-1&&(M[A]=m.totalSales,q[A]=m.totalReservations,S[A]=m.totalGuests||0,E[A]=Math.round(m.totalReservations*1.2)||0)});for(let m=1;m<=12;m++){const _=m.toString().padStart(2,"0");u[_]===void 0&&(u[_]=0,r[_]=0,s[_]=0,p[_]=0),M[_]===void 0&&(M[_]=0,q[_]=0,S[_]=0,E[_]=0)}}catch(Q){console.error("\uCD5C\uADFC 2\uB144\uAC04 \uB370\uC774\uD130 \uB85C\uB4DC \uC911 \uC624\uB958 \uBC1C\uC0DD:",Q);for(let G=1;G<=12;G++){const m=G.toString().padStart(2,"0");u[m]=0,r[m]=0,s[m]=0,p[m]=0,M[m]=0,q[m]=0,S[m]=0,E[m]=0}}finally{l.value=!1}C.value={currentYear:{revenue:u,reservations:r,peopleCount:s,roomCount:p},previousYear:{revenue:M,reservations:q,peopleCount:S,roomCount:E}}}return re(c,()=>{F()}),se(()=>{F()}),(n,u)=>(D(),Y(te,{padding:""},{default:i(()=>[a("div",Se,[qe,a("div",$e,[a("div",Re,[t(ce,{chartData:R.value,isLoading:l.value},null,8,["chartData","isLoading"])])]),a("div",Ee,[a("div",Ge,[t(pe,{chartData:j.value,isLoading:l.value},null,8,["chartData","isLoading"])])]),a("div",ke,[a("div",Oe,[t(he,{chartData:K.value,isLoading:l.value},null,8,["chartData","isLoading"])])]),a("div",ze,[a("div",Fe,[t(fe,{chartData:I.value,isLoading:l.value},null,8,["chartData","isLoading"])])]),a("div",Qe,[a("div",Pe,[t(ye,{selectedMonth:c.value,"onUpdate:selectedMonth":T},null,8,["selectedMonth"])]),a("div",Ne,[a("div",je,[a("div",Ke,[t(De,{totalSales:V.value,isLoading:h.value},null,8,["totalSales","isLoading"])]),a("div",Ie,[t(be,{totalReservations:J.value,isLoading:h.value},null,8,["totalReservations","isLoading"])])]),a("div",Te,[a("div",Ve,[t(xe,{roomAllocationStats:U.value,isLoading:h.value},null,8,["roomAllocationStats","isLoading"])])]),a("div",Je,[a("div",Ue,[t(we,{roomGroupOccupancyStats:W.value,isLoading:h.value},null,8,["roomGroupOccupancyStats","isLoading"])])]),a("div",We,[a("div",Xe,[t(Me,{totalGuests:X.value,isLoading:h.value},null,8,["totalGuests","isLoading"])])])])])])]),_:1}))}});export{ut as default};
